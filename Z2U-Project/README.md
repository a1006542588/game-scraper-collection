# Z2U Scraper - 使用说明

[![Version](https://img.shields.io/badge/version-7.4.3-blue.svg)](https://github.com/a1006542588/game-scraper-collection)
[![Platform](https://img.shields.io/badge/platform-Z2U.com-orange.svg)](https://www.z2u.com)

> Z2U.com 游戏交易平台数据采集工具

---

## 🚀 快速安装

**点击安装**: [Z2U-scraper.user.js](https://github.com/a1006542588/game-scraper-collection/raw/main/Z2U-Project/Z2U-scraper.user.js)

---

## ✨ 主要功能

- 🎮 **自动抓取游戏列表** - 获取所有游戏和服务类型
- 📦 **批量抓取产品订单** - 按游戏和服务类型抓取订单
- 💾 **导出 Excel 格式** - 支持 XLSX 格式，可用 Excel/WPS 打开
- 🛡️ **Cloudflare 验证** - 自动绕过 CF 验证
- 🔄 **增量更新** - 智能识别新订单，避免重复抓取

---

## 📝 使用教程

### 第一步：抓取游戏列表

```
1. 访问 Z2U.com 任意页面
2. 页面会出现悬浮控制面板
3. 点击"开始抓取游戏"按钮
4. 等待自动抓取完成（通常几分钟）
```

### 第二步：抓取产品订单

```
1. 从游戏列表中选择一个游戏
2. 选择服务类型（如 Game Coins、Items 等）
3. 点击"开始抓取订单"按钮
4. 脚本会自动访问产品页面并抓取数据
```

### 第三步：导出数据

```
1. 点击"导出 Excel"按钮
2. 数据会自动下载为 .xlsx 文件
3. 用 Excel 或 WPS 打开查看
```

---

## 📊 数据字段说明

**游戏列表数据**:
- 游戏名称
- 服务类型（Coins、Items、Accounts 等）
- 游戏链接

**产品订单数据**:
- 产品标题
- 产品链接
- 卖家名称
- 价格
- 库存状态
- 交付时间
- 更新时间

---

## 💡 使用技巧

### 增量更新

脚本会记录已抓取的订单，下次运行时只抓取新订单：

```
第一次运行: 抓取所有订单（100条）
第二次运行: 只抓取新增的订单（10条）
```

### 数据管理

- **清除游戏列表**: 当游戏列表变化时使用
- **清除订单数据**: 想重新抓取所有订单时使用

---

## ❓ 常见问题

### Q: Cloudflare 验证失败怎么办？

**A**: 手动完成一次验证，脚本会记录信息，后续自动处理。

### Q: 抓取速度慢？

**A**: 
- 检查网络连接
- 脚本已内置 20 秒超时保护
- 如果仍然超时，稍后重试

### Q: 导出的 Excel 文件打不开？

**A**: 
- 确保使用 Excel 2007 或更高版本
- 或使用 WPS Office
- 或使用在线 Excel 查看器

### Q: 数据不完整？

**A**: 
- 某些页面可能没有所有字段（正常现象）
- 检查网络是否稳定
- 查看浏览器控制台（F12）是否有错误

---

## 🔧 技术说明

### 存储位置

数据存储在 Tampermonkey 本地存储中：
- 键名: `z2u_games_data`
- 格式: JSON

### 数据大小限制

- 取决于浏览器（通常 5-10 MB）
- 建议定期导出并清除旧数据

---

## 📄 更新日志

### v7.4.3 (2025-10-06)
- 修复增量更新逻辑
- 优化数据存储结构
- 改进 Cloudflare 验证

### v7.4.1
- 增强 Cloudflare 绕过功能
- 修复订单重复问题

### v6.0
- 重构代码架构
- 添加游戏列表抓取
- 支持增量更新

---

## 📞 支持

遇到问题？

- [提交 Issue](https://github.com/a1006542588/game-scraper-collection/issues)
- 查看 [技术文档](docs/)

---

## 📜 许可证

MIT License

---

**返回**: [主页](../README.md) | **版本**: v7.4.3 | **更新**: 2025-10-06
